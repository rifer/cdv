//Demo of Searching and Sorting Table with AngularJS
var myApp = angular.module('myApp', []);

myApp.controller('TableCtrl', ['$scope', function ($scope) {

    $scope.allItems = getTableData();

    $scope.resetAll = function () {
        $scope.filteredList = $scope.allItems;
        $scope.newName = '';
        $scope.newOld = '';
        $scope.newData = '';
        $scope.newKind = '';
        $scope.searchText = '';
    }

    $scope.add = function () {
        $scope.allItems.push({
            name: $scope.newName,
            old: $scope.newOld,
            data: $scope.newData,
            kind: $scope.newKind
        });
        $scope.resetAll();
    }

    $scope.search = function () {
        $scope.filteredList = _.filter($scope.allItems,

        function (item) {
            return searchUtil(item, $scope.searchText);
        });

        if ($scope.searchText == '') {
            $scope.filteredList = $scope.allItems;
        }
    }

    $scope.resetAll();
}]);

/* Search Text in all 3 fields */
function searchUtil(item, toSearch) {
    /* Search Text in all 3 fields */
    return (item.data.toLowerCase().indexOf(toSearch.toLowerCase()) > -1 || item.name.toLowerCase().indexOf(toSearch.toLowerCase()) > -1 || item.old.toLowerCase().indexOf(toSearch.toLowerCase()) > -1 || item.kind == toSearch) ? true : false;
}

/*Get Dummy Data for Example*/
function getTableData() {
    return [{
        data: '23-10-1910',
        name: 'Jitendra López Andrés',
        old: '39',
        kind: 'fusilamiento'
    }, {
        data: '11-12-1910',
        name: 'Minal Álvarez Roldán',
        old: '26',
        kind: 'fusilamiento'
    }, {
        data: '01-12-1910',
        name: 'Ernesto Álvarez Roldán',
        old: '46',
        kind: 'natural'
    }, {
        data: '11-11-1914',
        name: 'Jesús Manmuel Roldán',
        old: '26',
        kind: 'garrote vil'
    }, {
        data: '03-09-1928',
        name: 'Rudra Lorenzo Almadía',
        old: '62',
        kind: 'fusilamiento'
    }, {
        data: '23-10-1910',
        name: 'Jitendra López Andrés',
        old: '39',
        kind: 'fusilamiento'
    }, {
        data: '11-12-1910',
        name: 'Minal Álvarez Roldán',
        old: '26',
        kind: 'fusilamiento'
    }, {
        data: '01-12-1910',
        name: 'Ernesto Álvarez Roldán',
        old: '46',
        kind: 'natural'
    }, {
        data: '11-11-1914',
        name: 'Jesús Manmuel Roldán',
        old: '26',
        kind: 'garrote vil'
    }, {
        data: '03-09-1928',
        name: 'Rudra Lorenzo Almadía',
        old: '62',
        kind: 'fusilamiento'
    }];
}